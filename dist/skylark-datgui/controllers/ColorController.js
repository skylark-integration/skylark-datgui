/**
 * skylark-datgui - A version of dat.gui.js  that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-datgui/
 * @license MIT
 */
define(["./Controller","../dom/dom","../color/Color","../color/interpret","../utils/common"],function(t,e,i,o,n){"use strict";const s=["-moz-","-o-","-webkit-","-ms-",""];function _(t,e,i,o){t.style.background="",n.each(s,function(n){t.style.cssText+="background: "+n+"linear-gradient("+e+", "+i+" 0%, "+o+" 100%); "})}return class extends t{constructor(t,s){super(t,s),this.__color=new i(this.getValue()),this.__temp=new i(0);const d=this;this.domElement=document.createElement("div"),e.makeSelectable(this.domElement,!1),this.__selector=document.createElement("div"),this.__selector.className="selector",this.__saturation_field=document.createElement("div"),this.__saturation_field.className="saturation-field",this.__field_knob=document.createElement("div"),this.__field_knob.className="field-knob",this.__field_knob_border="2px solid ",this.__hue_knob=document.createElement("div"),this.__hue_knob.className="hue-knob",this.__hue_field=document.createElement("div"),this.__hue_field.className="hue-field",this.__input=document.createElement("input"),this.__input.type="text",this.__input_textShadow="0 1px 1px ",e.bind(this.__input,"keydown",function(t){13===t.keyCode&&c.call(this)}),e.bind(this.__input,"blur",c),e.bind(this.__selector,"mousedown",function(){e.addClass(this,"drag").bind(window,"mouseup",function(){e.removeClass(d.__selector,"drag")})}),e.bind(this.__selector,"touchstart",function(){e.addClass(this,"drag").bind(window,"touchend",function(){e.removeClass(d.__selector,"drag")})});const l=document.createElement("div");var f;function h(t){b(t),e.bind(window,"mousemove",b),e.bind(window,"touchmove",b),e.bind(window,"mouseup",u),e.bind(window,"touchend",u)}function r(t){m(t),e.bind(window,"mousemove",m),e.bind(window,"touchmove",m),e.bind(window,"mouseup",a),e.bind(window,"touchend",a)}function u(){e.unbind(window,"mousemove",b),e.unbind(window,"touchmove",b),e.unbind(window,"mouseup",u),e.unbind(window,"touchend",u),p()}function a(){e.unbind(window,"mousemove",m),e.unbind(window,"touchmove",m),e.unbind(window,"mouseup",a),e.unbind(window,"touchend",a),p()}function c(){const t=o(this.value);!1!==t?(d.__color.__state=t,d.setValue(d.__color.toOriginal())):this.value=d.__color.toString()}function p(){d.__onFinishChange&&d.__onFinishChange.call(d,d.__color.toOriginal())}function b(t){-1===t.type.indexOf("touch")&&t.preventDefault();const e=d.__saturation_field.getBoundingClientRect(),{clientX:i,clientY:o}=t.touches&&t.touches[0]||t;let n=(i-e.left)/(e.right-e.left),s=1-(o-e.top)/(e.bottom-e.top);return s>1?s=1:s<0&&(s=0),n>1?n=1:n<0&&(n=0),d.__color.v=s,d.__color.s=n,d.setValue(d.__color.toOriginal()),!1}function m(t){-1===t.type.indexOf("touch")&&t.preventDefault();const e=d.__hue_field.getBoundingClientRect(),{clientY:i}=t.touches&&t.touches[0]||t;let o=1-(i-e.top)/(e.bottom-e.top);return o>1?o=1:o<0&&(o=0),d.__color.h=360*o,d.setValue(d.__color.toOriginal()),!1}n.extend(this.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),n.extend(this.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:this.__field_knob_border+(this.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),n.extend(this.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),n.extend(this.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),n.extend(l.style,{width:"100%",height:"100%",background:"none"}),_(l,"top","rgba(0,0,0,0)","#000"),n.extend(this.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),(f=this.__hue_field).style.background="",f.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",f.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",f.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",f.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",f.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.extend(this.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:this.__input_textShadow+"rgba(0,0,0,0.7)"}),e.bind(this.__saturation_field,"mousedown",h),e.bind(this.__saturation_field,"touchstart",h),e.bind(this.__field_knob,"mousedown",h),e.bind(this.__field_knob,"touchstart",h),e.bind(this.__hue_field,"mousedown",r),e.bind(this.__hue_field,"touchstart",r),this.__saturation_field.appendChild(l),this.__selector.appendChild(this.__field_knob),this.__selector.appendChild(this.__saturation_field),this.__selector.appendChild(this.__hue_field),this.__hue_field.appendChild(this.__hue_knob),this.domElement.appendChild(this.__input),this.domElement.appendChild(this.__selector),this.updateDisplay()}updateDisplay(){const t=o(this.getValue());if(!1!==t){let e=!1;n.each(i.COMPONENTS,function(i){if(!n.isUndefined(t[i])&&!n.isUndefined(this.__color.__state[i])&&t[i]!==this.__color.__state[i])return e=!0,{}},this),e&&n.extend(this.__color.__state,t)}n.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;const e=this.__color.v<.5||this.__color.s>.5?255:0,s=255-e;n.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+e+","+e+","+e+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,_(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),n.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+e+","+e+","+e+")",textShadow:this.__input_textShadow+"rgba("+s+","+s+","+s+",.7)"})}}});
//# sourceMappingURL=../sourcemaps/controllers/ColorController.js.map
