{"version":3,"sources":["gui/GUI.js"],"names":["define","css","saveDialogueContents","ControllerFactory","Controller","BooleanController","FunctionController","NumberControllerBox","NumberControllerSlider","ColorController","requestAnimationFrame","CenteredDiv","dom","common","styleSheet","DEFAULT_DEFAULT_PRESET_NAME","SUPPORTS_LOCAL_STORAGE","window","localStorage","e","SAVE_DIALOGUE","autoPlaceContainer","autoPlaceVirgin","hide","hideableGuis","GUI","pars","_this","this","params","domElement","document","createElement","__ul","appendChild","addClass","__folders","__controllers","__rememberedObjects","__rememberedObjectIndecesToControllers","__listening","defaults","closeOnTop","autoPlace","width","DEFAULT_WIDTH","resizable","hideable","isUndefined","load","preset","parent","push","scrollable","saveToLocalStorage","titleRow","useLocalStorage","getItem","getLocalStorageHash","Object","defineProperties","get","getRoot","set","v","gui","index","__preset_select","length","value","selectedIndex","setPresetSelectIndex","revert","setWidth","name","innerHTML","closed","CLASS_CLOSED","removeClass","onResize","__closeButton","TEXT_OPEN","TEXT_CLOSED","bool","bind","unbind","setItem","CLASS_MAIN","makeSelectable","savedGui","JSON","parse","CLASS_CLOSE_BUTTON","CLASS_CLOSE_TOP","insertBefore","childNodes","CLASS_CLOSE_BOTTOM","undefined","titleRowName","createTextNode","addRow","onClickTitle","preventDefault","CLASS_AUTO_PLACE_CONTAINER","body","CLASS_AUTO_PLACE","__resizeHandler","onResizeDebounced","pmouseX","drag","clientX","dragStop","CLASS_DRAG","dragStart","__resize_handle","extend","style","marginLeft","height","cursor","position","firstElementChild","addResizeHandle","stringify","getSaveObject","saveToLocalStorageIfPossible","root","defer","resetWidth","newDom","liBefore","li","removeListeners","markPresetModified","modified","opt","recallSavedValue","controller","matchedIndex","indexOf","object","controllerMap","property","remembered","presetMap","initialValue","setValue","add","Error","color","factoryArgs","concat","apply","before","__li","container","CLASS_CONTROLLER_ROW","getValue","__gui","options","arguments","nextSibling","nextElementSibling","remove","toArray","isArray","isObject","listen","box","min","__min","max","__max","step","__step","each","method","pc","pb","args","Array","prototype","slice","call","r","returned","isNumber","oldName","wasListening","newController","compose","fakeEvent","__checkbox","stopPropagation","__button","updateDisplay","val","borderLeftColor","__color","toString","isModified","augmentController","key","location","href","addPresetOption","setSelected","showHideExplain","explain","display","w","__save_row","getCurrentPreset","useInitialValues","toReturn","savedValues","toggleHide","CLASS_TOO_TALL","_keydownHandler","activeElement","type","which","keyCode","addColor","removeChild","splice","destroy","subfolder","removeFolder","addFolder","newGuiParams","folders","folder","parentElement","open","close","show","top","getOffset","h","node","getHeight","innerHeight","offsetHeight","debounce","remember","div","firstChild","gears","button","button2","button3","select","getElementById","localStorageCheckBox","saveLocally","setAttribute","newConstructorTextArea","metaKey","focus","save","presetName","prompt","saveAs","addSaveMenu","element","__onFinishChange","init","updateDisplays","controllerArray","c"],"mappings":"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","file":"../../gui/GUI.js","sourcesContent":["define([\n    '../utils/css',\n    './saveDialogue.html',\n    '../controllers/ControllerFactory',\n    '../controllers/Controller',\n    '../controllers/BooleanController',\n    '../controllers/FunctionController',\n    '../controllers/NumberControllerBox',\n    '../controllers/NumberControllerSlider',\n    '../controllers/ColorController',\n    '../utils/requestAnimationFrame',\n    '../dom/CenteredDiv',\n    '../dom/dom',\n    '../utils/common'\n], function (css, saveDialogueContents, ControllerFactory, Controller, BooleanController, FunctionController, NumberControllerBox, NumberControllerSlider, ColorController, requestAnimationFrame, CenteredDiv, dom, common, styleSheet) {\n    'use strict';\n\n    //css.inject(styleSheet);\n\n    const CSS_NAMESPACE = 'dg';\n    const HIDE_KEY_CODE = 72;\n    const CLOSE_BUTTON_HEIGHT = 20;\n    const DEFAULT_DEFAULT_PRESET_NAME = 'Default';\n    const SUPPORTS_LOCAL_STORAGE = function () {\n        try {\n            return !!window.localStorage;\n        } catch (e) {\n            return false;\n        }\n    }();\n    let SAVE_DIALOGUE;\n    let autoPlaceVirgin = true;\n    let autoPlaceContainer;\n    let hide = false;\n    const hideableGuis = [];\n    const GUI = function (pars) {\n        const _this = this;\n        let params = pars || {};\n        this.domElement = document.createElement('div');\n        this.__ul = document.createElement('ul');\n        this.domElement.appendChild(this.__ul);\n        dom.addClass(this.domElement, CSS_NAMESPACE);\n        this.__folders = {};\n        this.__controllers = [];\n        this.__rememberedObjects = [];\n        this.__rememberedObjectIndecesToControllers = [];\n        this.__listening = [];\n        params = common.defaults(params, {\n            closeOnTop: false,\n            autoPlace: true,\n            width: GUI.DEFAULT_WIDTH\n        });\n        params = common.defaults(params, {\n            resizable: params.autoPlace,\n            hideable: params.autoPlace\n        });\n        if (!common.isUndefined(params.load)) {\n            if (params.preset) {\n                params.load.preset = params.preset;\n            }\n        } else {\n            params.load = { preset: DEFAULT_DEFAULT_PRESET_NAME };\n        }\n        if (common.isUndefined(params.parent) && params.hideable) {\n            hideableGuis.push(this);\n        }\n        params.resizable = common.isUndefined(params.parent) && params.resizable;\n        if (params.autoPlace && common.isUndefined(params.scrollable)) {\n            params.scrollable = true;\n        }\n        let useLocalStorage = SUPPORTS_LOCAL_STORAGE && localStorage.getItem(getLocalStorageHash(this, 'isLocal')) === 'true';\n        let saveToLocalStorage;\n        let titleRow;\n        Object.defineProperties(this, {\n            parent: {\n                get: function () {\n                    return params.parent;\n                }\n            },\n            scrollable: {\n                get: function () {\n                    return params.scrollable;\n                }\n            },\n            autoPlace: {\n                get: function () {\n                    return params.autoPlace;\n                }\n            },\n            closeOnTop: {\n                get: function () {\n                    return params.closeOnTop;\n                }\n            },\n            preset: {\n                get: function () {\n                    if (_this.parent) {\n                        return _this.getRoot().preset;\n                    }\n                    return params.load.preset;\n                },\n                set: function (v) {\n                    if (_this.parent) {\n                        _this.getRoot().preset = v;\n                    } else {\n                        params.load.preset = v;\n                    }\n                    setPresetSelectIndex(this);\n                    _this.revert();\n                }\n            },\n            width: {\n                get: function () {\n                    return params.width;\n                },\n                set: function (v) {\n                    params.width = v;\n                    setWidth(_this, v);\n                }\n            },\n            name: {\n                get: function () {\n                    return params.name;\n                },\n                set: function (v) {\n                    params.name = v;\n                    if (titleRow) {\n                        titleRow.innerHTML = params.name;\n                    }\n                }\n            },\n            closed: {\n                get: function () {\n                    return params.closed;\n                },\n                set: function (v) {\n                    params.closed = v;\n                    if (params.closed) {\n                        dom.addClass(_this.__ul, GUI.CLASS_CLOSED);\n                    } else {\n                        dom.removeClass(_this.__ul, GUI.CLASS_CLOSED);\n                    }\n                    this.onResize();\n                    if (_this.__closeButton) {\n                        _this.__closeButton.innerHTML = v ? GUI.TEXT_OPEN : GUI.TEXT_CLOSED;\n                    }\n                }\n            },\n            load: {\n                get: function () {\n                    return params.load;\n                }\n            },\n            useLocalStorage: {\n                get: function () {\n                    return useLocalStorage;\n                },\n                set: function (bool) {\n                    if (SUPPORTS_LOCAL_STORAGE) {\n                        useLocalStorage = bool;\n                        if (bool) {\n                            dom.bind(window, 'unload', saveToLocalStorage);\n                        } else {\n                            dom.unbind(window, 'unload', saveToLocalStorage);\n                        }\n                        localStorage.setItem(getLocalStorageHash(_this, 'isLocal'), bool);\n                    }\n                }\n            }\n        });\n        if (common.isUndefined(params.parent)) {\n            this.closed = params.closed || false;\n            dom.addClass(this.domElement, GUI.CLASS_MAIN);\n            dom.makeSelectable(this.domElement, false);\n            if (SUPPORTS_LOCAL_STORAGE) {\n                if (useLocalStorage) {\n                    _this.useLocalStorage = true;\n                    const savedGui = localStorage.getItem(getLocalStorageHash(this, 'gui'));\n                    if (savedGui) {\n                        params.load = JSON.parse(savedGui);\n                    }\n                }\n            }\n            this.__closeButton = document.createElement('div');\n            this.__closeButton.innerHTML = GUI.TEXT_CLOSED;\n            dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_BUTTON);\n            if (params.closeOnTop) {\n                dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_TOP);\n                this.domElement.insertBefore(this.__closeButton, this.domElement.childNodes[0]);\n            } else {\n                dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_BOTTOM);\n                this.domElement.appendChild(this.__closeButton);\n            }\n            dom.bind(this.__closeButton, 'click', function () {\n                _this.closed = !_this.closed;\n            });\n        } else {\n            if (params.closed === undefined) {\n                params.closed = true;\n            }\n            const titleRowName = document.createTextNode(params.name);\n            dom.addClass(titleRowName, 'controller-name');\n            titleRow = addRow(_this, titleRowName);\n            const onClickTitle = function (e) {\n                e.preventDefault();\n                _this.closed = !_this.closed;\n                return false;\n            };\n            dom.addClass(this.__ul, GUI.CLASS_CLOSED);\n            dom.addClass(titleRow, 'title');\n            dom.bind(titleRow, 'click', onClickTitle);\n            if (!params.closed) {\n                this.closed = false;\n            }\n        }\n        if (params.autoPlace) {\n            if (common.isUndefined(params.parent)) {\n                if (autoPlaceVirgin) {\n                    autoPlaceContainer = document.createElement('div');\n                    dom.addClass(autoPlaceContainer, CSS_NAMESPACE);\n                    dom.addClass(autoPlaceContainer, GUI.CLASS_AUTO_PLACE_CONTAINER);\n                    document.body.appendChild(autoPlaceContainer);\n                    autoPlaceVirgin = false;\n                }\n                autoPlaceContainer.appendChild(this.domElement);\n                dom.addClass(this.domElement, GUI.CLASS_AUTO_PLACE);\n            }\n            if (!this.parent) {\n                setWidth(_this, params.width);\n            }\n        }\n        this.__resizeHandler = function () {\n            _this.onResizeDebounced();\n        };\n        dom.bind(window, 'resize', this.__resizeHandler);\n        dom.bind(this.__ul, 'webkitTransitionEnd', this.__resizeHandler);\n        dom.bind(this.__ul, 'transitionend', this.__resizeHandler);\n        dom.bind(this.__ul, 'oTransitionEnd', this.__resizeHandler);\n        this.onResize();\n        if (params.resizable) {\n            addResizeHandle(this);\n        }\n        saveToLocalStorage = function () {\n            if (SUPPORTS_LOCAL_STORAGE && localStorage.getItem(getLocalStorageHash(_this, 'isLocal')) === 'true') {\n                localStorage.setItem(getLocalStorageHash(_this, 'gui'), JSON.stringify(_this.getSaveObject()));\n            }\n        };\n        this.saveToLocalStorageIfPossible = saveToLocalStorage;\n        function resetWidth() {\n            const root = _this.getRoot();\n            root.width += 1;\n            common.defer(function () {\n                root.width -= 1;\n            });\n        }\n        if (!params.parent) {\n            resetWidth();\n        }\n    };\n    GUI.toggleHide = function () {\n        hide = !hide;\n        common.each(hideableGuis, function (gui) {\n            gui.domElement.style.display = hide ? 'none' : '';\n        });\n    };\n    GUI.CLASS_AUTO_PLACE = 'a';\n    GUI.CLASS_AUTO_PLACE_CONTAINER = 'ac';\n    GUI.CLASS_MAIN = 'main';\n    GUI.CLASS_CONTROLLER_ROW = 'cr';\n    GUI.CLASS_TOO_TALL = 'taller-than-window';\n    GUI.CLASS_CLOSED = 'closed';\n    GUI.CLASS_CLOSE_BUTTON = 'close-button';\n    GUI.CLASS_CLOSE_TOP = 'close-top';\n    GUI.CLASS_CLOSE_BOTTOM = 'close-bottom';\n    GUI.CLASS_DRAG = 'drag';\n    GUI.DEFAULT_WIDTH = 245;\n    GUI.TEXT_CLOSED = 'Close Controls';\n    GUI.TEXT_OPEN = 'Open Controls';\n    GUI._keydownHandler = function (e) {\n        if (document.activeElement.type !== 'text' && (e.which === HIDE_KEY_CODE || e.keyCode === HIDE_KEY_CODE)) {\n            GUI.toggleHide();\n        }\n    };\n    dom.bind(window, 'keydown', GUI._keydownHandler, false);\n    common.extend(GUI.prototype, {\n        add: function (object, property) {\n            return add(this, object, property, { factoryArgs: Array.prototype.slice.call(arguments, 2) });\n        },\n        addColor: function (object, property) {\n            return add(this, object, property, { color: true });\n        },\n        remove: function (controller) {\n            this.__ul.removeChild(controller.__li);\n            this.__controllers.splice(this.__controllers.indexOf(controller), 1);\n            const _this = this;\n            common.defer(function () {\n                _this.onResize();\n            });\n        },\n        destroy: function () {\n            if (this.parent) {\n                throw new Error('Only the root GUI should be removed with .destroy(). ' + 'For subfolders, use gui.removeFolder(folder) instead.');\n            }\n            if (this.autoPlace) {\n                autoPlaceContainer.removeChild(this.domElement);\n            }\n            const _this = this;\n            common.each(this.__folders, function (subfolder) {\n                _this.removeFolder(subfolder);\n            });\n            dom.unbind(window, 'keydown', GUI._keydownHandler, false);\n            removeListeners(this);\n        },\n        addFolder: function (name) {\n            if (this.__folders[name] !== undefined) {\n                throw new Error('You already have a folder in this GUI by the' + ' name \"' + name + '\"');\n            }\n            const newGuiParams = {\n                name: name,\n                parent: this\n            };\n            newGuiParams.autoPlace = this.autoPlace;\n            if (this.load && this.load.folders && this.load.folders[name]) {\n                newGuiParams.closed = this.load.folders[name].closed;\n                newGuiParams.load = this.load.folders[name];\n            }\n            const gui = new GUI(newGuiParams);\n            this.__folders[name] = gui;\n            const li = addRow(this, gui.domElement);\n            dom.addClass(li, 'folder');\n            return gui;\n        },\n        removeFolder: function (folder) {\n            this.__ul.removeChild(folder.domElement.parentElement);\n            delete this.__folders[folder.name];\n            if (this.load && this.load.folders && this.load.folders[folder.name]) {\n                delete this.load.folders[folder.name];\n            }\n            removeListeners(folder);\n            const _this = this;\n            common.each(folder.__folders, function (subfolder) {\n                folder.removeFolder(subfolder);\n            });\n            common.defer(function () {\n                _this.onResize();\n            });\n        },\n        open: function () {\n            this.closed = false;\n        },\n        close: function () {\n            this.closed = true;\n        },\n        hide: function () {\n            this.domElement.style.display = 'none';\n        },\n        show: function () {\n            this.domElement.style.display = '';\n        },\n        onResize: function () {\n            const root = this.getRoot();\n            if (root.scrollable) {\n                const top = dom.getOffset(root.__ul).top;\n                let h = 0;\n                common.each(root.__ul.childNodes, function (node) {\n                    if (!(root.autoPlace && node === root.__save_row)) {\n                        h += dom.getHeight(node);\n                    }\n                });\n                if (window.innerHeight - top - CLOSE_BUTTON_HEIGHT < h) {\n                    dom.addClass(root.domElement, GUI.CLASS_TOO_TALL);\n                    root.__ul.style.height = window.innerHeight - top - CLOSE_BUTTON_HEIGHT + 'px';\n                } else {\n                    dom.removeClass(root.domElement, GUI.CLASS_TOO_TALL);\n                    root.__ul.style.height = 'auto';\n                }\n            }\n            if (root.__resize_handle) {\n                common.defer(function () {\n                    root.__resize_handle.style.height = root.__ul.offsetHeight + 'px';\n                });\n            }\n            if (root.__closeButton) {\n                root.__closeButton.style.width = root.width + 'px';\n            }\n        },\n        onResizeDebounced: common.debounce(function () {\n            this.onResize();\n        }, 50),\n        remember: function () {\n            if (common.isUndefined(SAVE_DIALOGUE)) {\n                SAVE_DIALOGUE = new CenteredDiv();\n                SAVE_DIALOGUE.domElement.innerHTML = saveDialogueContents;\n            }\n            if (this.parent) {\n                throw new Error('You can only call remember on a top level GUI.');\n            }\n            const _this = this;\n            common.each(Array.prototype.slice.call(arguments), function (object) {\n                if (_this.__rememberedObjects.length === 0) {\n                    addSaveMenu(_this);\n                }\n                if (_this.__rememberedObjects.indexOf(object) === -1) {\n                    _this.__rememberedObjects.push(object);\n                }\n            });\n            if (this.autoPlace) {\n                setWidth(this, this.width);\n            }\n        },\n        getRoot: function () {\n            let gui = this;\n            while (gui.parent) {\n                gui = gui.parent;\n            }\n            return gui;\n        },\n        getSaveObject: function () {\n            const toReturn = this.load;\n            toReturn.closed = this.closed;\n            if (this.__rememberedObjects.length > 0) {\n                toReturn.preset = this.preset;\n                if (!toReturn.remembered) {\n                    toReturn.remembered = {};\n                }\n                toReturn.remembered[this.preset] = getCurrentPreset(this);\n            }\n            toReturn.folders = {};\n            common.each(this.__folders, function (element, key) {\n                toReturn.folders[key] = element.getSaveObject();\n            });\n            return toReturn;\n        },\n        save: function () {\n            if (!this.load.remembered) {\n                this.load.remembered = {};\n            }\n            this.load.remembered[this.preset] = getCurrentPreset(this);\n            markPresetModified(this, false);\n            this.saveToLocalStorageIfPossible();\n        },\n        saveAs: function (presetName) {\n            if (!this.load.remembered) {\n                this.load.remembered = {};\n                this.load.remembered[DEFAULT_DEFAULT_PRESET_NAME] = getCurrentPreset(this, true);\n            }\n            this.load.remembered[presetName] = getCurrentPreset(this);\n            this.preset = presetName;\n            addPresetOption(this, presetName, true);\n            this.saveToLocalStorageIfPossible();\n        },\n        revert: function (gui) {\n            common.each(this.__controllers, function (controller) {\n                if (!this.getRoot().load.remembered) {\n                    controller.setValue(controller.initialValue);\n                } else {\n                    recallSavedValue(gui || this.getRoot(), controller);\n                }\n                if (controller.__onFinishChange) {\n                    controller.__onFinishChange.call(controller, controller.getValue());\n                }\n            }, this);\n            common.each(this.__folders, function (folder) {\n                folder.revert(folder);\n            });\n            if (!gui) {\n                markPresetModified(this.getRoot(), false);\n            }\n        },\n        listen: function (controller) {\n            const init = this.__listening.length === 0;\n            this.__listening.push(controller);\n            if (init) {\n                updateDisplays(this.__listening);\n            }\n        },\n        updateDisplay: function () {\n            common.each(this.__controllers, function (controller) {\n                controller.updateDisplay();\n            });\n            common.each(this.__folders, function (folder) {\n                folder.updateDisplay();\n            });\n        }\n    });\n    function addRow(gui, newDom, liBefore) {\n        const li = document.createElement('li');\n        if (newDom) {\n            li.appendChild(newDom);\n        }\n        if (liBefore) {\n            gui.__ul.insertBefore(li, liBefore);\n        } else {\n            gui.__ul.appendChild(li);\n        }\n        gui.onResize();\n        return li;\n    }\n    function removeListeners(gui) {\n        dom.unbind(window, 'resize', gui.__resizeHandler);\n        if (gui.saveToLocalStorageIfPossible) {\n            dom.unbind(window, 'unload', gui.saveToLocalStorageIfPossible);\n        }\n    }\n    function markPresetModified(gui, modified) {\n        const opt = gui.__preset_select[gui.__preset_select.selectedIndex];\n        if (modified) {\n            opt.innerHTML = opt.value + '*';\n        } else {\n            opt.innerHTML = opt.value;\n        }\n    }\n    function augmentController(gui, li, controller) {\n        controller.__li = li;\n        controller.__gui = gui;\n        common.extend(controller, {\n            options: function (options) {\n                if (arguments.length > 1) {\n                    const nextSibling = controller.__li.nextElementSibling;\n                    controller.remove();\n                    return add(gui, controller.object, controller.property, {\n                        before: nextSibling,\n                        factoryArgs: [common.toArray(arguments)]\n                    });\n                }\n                if (common.isArray(options) || common.isObject(options)) {\n                    const nextSibling = controller.__li.nextElementSibling;\n                    controller.remove();\n                    return add(gui, controller.object, controller.property, {\n                        before: nextSibling,\n                        factoryArgs: [options]\n                    });\n                }\n            },\n            name: function (name) {\n                controller.__li.firstElementChild.firstElementChild.innerHTML = name;\n                return controller;\n            },\n            listen: function () {\n                controller.__gui.listen(controller);\n                return controller;\n            },\n            remove: function () {\n                controller.__gui.remove(controller);\n                return controller;\n            }\n        });\n        if (controller instanceof NumberControllerSlider) {\n            const box = new NumberControllerBox(controller.object, controller.property, {\n                min: controller.__min,\n                max: controller.__max,\n                step: controller.__step\n            });\n            common.each([\n                'updateDisplay',\n                'onChange',\n                'onFinishChange',\n                'step',\n                'min',\n                'max'\n            ], function (method) {\n                const pc = controller[method];\n                const pb = box[method];\n                controller[method] = box[method] = function () {\n                    const args = Array.prototype.slice.call(arguments);\n                    pb.apply(box, args);\n                    return pc.apply(controller, args);\n                };\n            });\n            dom.addClass(li, 'has-slider');\n            controller.domElement.insertBefore(box.domElement, controller.domElement.firstElementChild);\n        } else if (controller instanceof NumberControllerBox) {\n            const r = function (returned) {\n                if (common.isNumber(controller.__min) && common.isNumber(controller.__max)) {\n                    const oldName = controller.__li.firstElementChild.firstElementChild.innerHTML;\n                    const wasListening = controller.__gui.__listening.indexOf(controller) > -1;\n                    controller.remove();\n                    const newController = add(gui, controller.object, controller.property, {\n                        before: controller.__li.nextElementSibling,\n                        factoryArgs: [\n                            controller.__min,\n                            controller.__max,\n                            controller.__step\n                        ]\n                    });\n                    newController.name(oldName);\n                    if (wasListening)\n                        newController.listen();\n                    return newController;\n                }\n                return returned;\n            };\n            controller.min = common.compose(r, controller.min);\n            controller.max = common.compose(r, controller.max);\n        } else if (controller instanceof BooleanController) {\n            dom.bind(li, 'click', function () {\n                dom.fakeEvent(controller.__checkbox, 'click');\n            });\n            dom.bind(controller.__checkbox, 'click', function (e) {\n                e.stopPropagation();\n            });\n        } else if (controller instanceof FunctionController) {\n            dom.bind(li, 'click', function () {\n                dom.fakeEvent(controller.__button, 'click');\n            });\n            dom.bind(li, 'mouseover', function () {\n                dom.addClass(controller.__button, 'hover');\n            });\n            dom.bind(li, 'mouseout', function () {\n                dom.removeClass(controller.__button, 'hover');\n            });\n        } else if (controller instanceof ColorController) {\n            dom.addClass(li, 'color');\n            controller.updateDisplay = common.compose(function (val) {\n                li.style.borderLeftColor = controller.__color.toString();\n                return val;\n            }, controller.updateDisplay);\n            controller.updateDisplay();\n        }\n        controller.setValue = common.compose(function (val) {\n            if (gui.getRoot().__preset_select && controller.isModified()) {\n                markPresetModified(gui.getRoot(), true);\n            }\n            return val;\n        }, controller.setValue);\n    }\n    function recallSavedValue(gui, controller) {\n        const root = gui.getRoot();\n        const matchedIndex = root.__rememberedObjects.indexOf(controller.object);\n        if (matchedIndex !== -1) {\n            let controllerMap = root.__rememberedObjectIndecesToControllers[matchedIndex];\n            if (controllerMap === undefined) {\n                controllerMap = {};\n                root.__rememberedObjectIndecesToControllers[matchedIndex] = controllerMap;\n            }\n            controllerMap[controller.property] = controller;\n            if (root.load && root.load.remembered) {\n                const presetMap = root.load.remembered;\n                let preset;\n                if (presetMap[gui.preset]) {\n                    preset = presetMap[gui.preset];\n                } else if (presetMap[DEFAULT_DEFAULT_PRESET_NAME]) {\n                    preset = presetMap[DEFAULT_DEFAULT_PRESET_NAME];\n                } else {\n                    return;\n                }\n                if (preset[matchedIndex] && preset[matchedIndex][controller.property] !== undefined) {\n                    const value = preset[matchedIndex][controller.property];\n                    controller.initialValue = value;\n                    controller.setValue(value);\n                }\n            }\n        }\n    }\n    function add(gui, object, property, params) {\n        if (object[property] === undefined) {\n            throw new Error(`Object \"${ object }\" has no property \"${ property }\"`);\n        }\n        let controller;\n        if (params.color) {\n            controller = new ColorController(object, property);\n        } else {\n            const factoryArgs = [\n                object,\n                property\n            ].concat(params.factoryArgs);\n            controller = ControllerFactory.apply(gui, factoryArgs);\n        }\n        if (params.before instanceof Controller) {\n            params.before = params.before.__li;\n        }\n        recallSavedValue(gui, controller);\n        dom.addClass(controller.domElement, 'c');\n        const name = document.createElement('span');\n        dom.addClass(name, 'property-name');\n        name.innerHTML = controller.property;\n        const container = document.createElement('div');\n        container.appendChild(name);\n        container.appendChild(controller.domElement);\n        const li = addRow(gui, container, params.before);\n        dom.addClass(li, GUI.CLASS_CONTROLLER_ROW);\n        if (controller instanceof ColorController) {\n            dom.addClass(li, 'color');\n        } else {\n            dom.addClass(li, typeof controller.getValue());\n        }\n        augmentController(gui, li, controller);\n        gui.__controllers.push(controller);\n        return controller;\n    }\n    function getLocalStorageHash(gui, key) {\n        return document.location.href + '.' + key;\n    }\n    function addPresetOption(gui, name, setSelected) {\n        const opt = document.createElement('option');\n        opt.innerHTML = name;\n        opt.value = name;\n        gui.__preset_select.appendChild(opt);\n        if (setSelected) {\n            gui.__preset_select.selectedIndex = gui.__preset_select.length - 1;\n        }\n    }\n    function showHideExplain(gui, explain) {\n        explain.style.display = gui.useLocalStorage ? 'block' : 'none';\n    }\n    function addSaveMenu(gui) {\n        const div = gui.__save_row = document.createElement('li');\n        dom.addClass(gui.domElement, 'has-save');\n        gui.__ul.insertBefore(div, gui.__ul.firstChild);\n        dom.addClass(div, 'save-row');\n        const gears = document.createElement('span');\n        gears.innerHTML = '&nbsp;';\n        dom.addClass(gears, 'button gears');\n        const button = document.createElement('span');\n        button.innerHTML = 'Save';\n        dom.addClass(button, 'button');\n        dom.addClass(button, 'save');\n        const button2 = document.createElement('span');\n        button2.innerHTML = 'New';\n        dom.addClass(button2, 'button');\n        dom.addClass(button2, 'save-as');\n        const button3 = document.createElement('span');\n        button3.innerHTML = 'Revert';\n        dom.addClass(button3, 'button');\n        dom.addClass(button3, 'revert');\n        const select = gui.__preset_select = document.createElement('select');\n        if (gui.load && gui.load.remembered) {\n            common.each(gui.load.remembered, function (value, key) {\n                addPresetOption(gui, key, key === gui.preset);\n            });\n        } else {\n            addPresetOption(gui, DEFAULT_DEFAULT_PRESET_NAME, false);\n        }\n        dom.bind(select, 'change', function () {\n            for (let index = 0; index < gui.__preset_select.length; index++) {\n                gui.__preset_select[index].innerHTML = gui.__preset_select[index].value;\n            }\n            gui.preset = this.value;\n        });\n        div.appendChild(select);\n        div.appendChild(gears);\n        div.appendChild(button);\n        div.appendChild(button2);\n        div.appendChild(button3);\n        if (SUPPORTS_LOCAL_STORAGE) {\n            const explain = document.getElementById('dg-local-explain');\n            const localStorageCheckBox = document.getElementById('dg-local-storage');\n            const saveLocally = document.getElementById('dg-save-locally');\n            saveLocally.style.display = 'block';\n            if (localStorage.getItem(getLocalStorageHash(gui, 'isLocal')) === 'true') {\n                localStorageCheckBox.setAttribute('checked', 'checked');\n            }\n            showHideExplain(gui, explain);\n            dom.bind(localStorageCheckBox, 'change', function () {\n                gui.useLocalStorage = !gui.useLocalStorage;\n                showHideExplain(gui, explain);\n            });\n        }\n        const newConstructorTextArea = document.getElementById('dg-new-constructor');\n        dom.bind(newConstructorTextArea, 'keydown', function (e) {\n            if (e.metaKey && (e.which === 67 || e.keyCode === 67)) {\n                SAVE_DIALOGUE.hide();\n            }\n        });\n        dom.bind(gears, 'click', function () {\n            newConstructorTextArea.innerHTML = JSON.stringify(gui.getSaveObject(), undefined, 2);\n            SAVE_DIALOGUE.show();\n            newConstructorTextArea.focus();\n            newConstructorTextArea.select();\n        });\n        dom.bind(button, 'click', function () {\n            gui.save();\n        });\n        dom.bind(button2, 'click', function () {\n            const presetName = prompt('Enter a new preset name.');\n            if (presetName) {\n                gui.saveAs(presetName);\n            }\n        });\n        dom.bind(button3, 'click', function () {\n            gui.revert();\n        });\n    }\n    function addResizeHandle(gui) {\n        let pmouseX;\n        gui.__resize_handle = document.createElement('div');\n        common.extend(gui.__resize_handle.style, {\n            width: '6px',\n            marginLeft: '-3px',\n            height: '200px',\n            cursor: 'ew-resize',\n            position: 'absolute'\n        });\n        function drag(e) {\n            e.preventDefault();\n            gui.width += pmouseX - e.clientX;\n            gui.onResize();\n            pmouseX = e.clientX;\n            return false;\n        }\n        function dragStop() {\n            dom.removeClass(gui.__closeButton, GUI.CLASS_DRAG);\n            dom.unbind(window, 'mousemove', drag);\n            dom.unbind(window, 'mouseup', dragStop);\n        }\n        function dragStart(e) {\n            e.preventDefault();\n            pmouseX = e.clientX;\n            dom.addClass(gui.__closeButton, GUI.CLASS_DRAG);\n            dom.bind(window, 'mousemove', drag);\n            dom.bind(window, 'mouseup', dragStop);\n            return false;\n        }\n        dom.bind(gui.__resize_handle, 'mousedown', dragStart);\n        dom.bind(gui.__closeButton, 'mousedown', dragStart);\n        gui.domElement.insertBefore(gui.__resize_handle, gui.domElement.firstElementChild);\n    }\n    function setWidth(gui, w) {\n        gui.domElement.style.width = w + 'px';\n        if (gui.__save_row && gui.autoPlace) {\n            gui.__save_row.style.width = w + 'px';\n        }\n        if (gui.__closeButton) {\n            gui.__closeButton.style.width = w + 'px';\n        }\n    }\n    function getCurrentPreset(gui, useInitialValues) {\n        const toReturn = {};\n        common.each(gui.__rememberedObjects, function (val, index) {\n            const savedValues = {};\n            const controllerMap = gui.__rememberedObjectIndecesToControllers[index];\n            common.each(controllerMap, function (controller, property) {\n                savedValues[property] = useInitialValues ? controller.initialValue : controller.getValue();\n            });\n            toReturn[index] = savedValues;\n        });\n        return toReturn;\n    }\n    function setPresetSelectIndex(gui) {\n        for (let index = 0; index < gui.__preset_select.length; index++) {\n            if (gui.__preset_select[index].value === gui.preset) {\n                gui.__preset_select.selectedIndex = index;\n            }\n        }\n    }\n    function updateDisplays(controllerArray) {\n        if (controllerArray.length !== 0) {\n            requestAnimationFrame.call(window, function () {\n                updateDisplays(controllerArray);\n            });\n        }\n        common.each(controllerArray, function (c) {\n            c.updateDisplay();\n        });\n    }\n    return GUI;\n});"]}